import{f as _,a as h}from"./CUf5UZYF.js";import"./BoQy5TvO.js";import{w as ne,c as ie}from"./JjBbrouE.js";import{a6 as ce,z as b,a7 as y,a8 as ue,ab as fe,k as m,M as G,i as e,ac as w,a4 as p,u as S,a5 as v,aa as x,a2 as ve,a9 as de,ad as pe}from"./C6kp5iGx.js";import{s as k,e as K}from"./Dvw9CKj1.js";import{i as C}from"./BMTi0gWB.js";import{e as Q,b as U,r as Y,i as ge}from"./DPurX8ys.js";import{s as he}from"./CK8WfoRq.js";import{s as me}from"./D6eV9jrv.js";import{b as _e}from"./oa8gdtCF.js";import{i as be}from"./BvILkHPm.js";import{p as E}from"./B8Ahxlw9.js";import{s as ye,a as A}from"./B2umgvaE.js";import{g as we}from"./BqC4448f.js";import{p as Se}from"./CG_yMqQE.js";const H="jastipku-cart",F={items:[]},qe=(()=>{try{const d=localStorage.getItem(H);return d?JSON.parse(d):F}catch(d){return console.warn("Failed to read cart from storage",d),F}})();function Re(){const{subscribe:d,set:q,update:R}=ne(qe);return d(o=>{try{localStorage.setItem(H,JSON.stringify(o))}catch(l){console.warn("Failed to persist cart",l)}}),{subscribe:d,addItem:(o,l=1,r={})=>{R(i=>{const s=i.items.findIndex(g=>g.listingId===o.id&&JSON.stringify(g.customDetails)===JSON.stringify(r));return s>=0?i.items[s].quantity+=l:i.items.push({id:Date.now().toString(),listingId:o.id,listing:o,quantity:l,customDetails:r,addedAt:new Date().toISOString()}),i})},updateQuantity:(o,l)=>{R(r=>{const i=r.items.find(s=>s.id===o);return i&&(i.quantity=Math.max(1,l)),r})},removeItem:o=>{R(l=>(l.items=l.items.filter(r=>r.id!==o),l))},clearCart:()=>{q(F)},getItemCount:o=>o.items.reduce((l,r)=>l+r.quantity,0),getTotalPrice:o=>o.items.reduce((l,r)=>{const i=r.listing;let s=0;if(i.type==="preloved")s=i.price*r.quantity;else{const g=r.customDetails.estimatedPrice||i.minOrder||0,I=g*(i.fee||0)/100;s=(g+I)*r.quantity}return l+s},0)}}const je=Re();var Ie=_("<a> </a>"),xe=_('<span class="cart-badge svelte-rfuq4y"> </span>'),Pe=_('<a class="cart-button svelte-rfuq4y" href="/cart"><span class="cart-icon svelte-rfuq4y">ğŸ›’</span> <!></a>'),ke=_('<a class="ghost svelte-rfuq4y" href="/login">Login</a> <button class="primary svelte-rfuq4y" type="button">Daftar</button>',1),Ce=_('<div class="role-indicator svelte-rfuq4y"><span> </span></div> <button class="ghost svelte-rfuq4y" type="button">Logout</button>',1),Le=_("<option> </option>"),Oe=_('<div class="language svelte-rfuq4y"><span>ğŸŒ</span> <select class="svelte-rfuq4y"></select></div>'),De=_('<nav class="navbar svelte-rfuq4y"><a class="brand svelte-rfuq4y" href="/"><img src="/logo.svg" alt="Jastipku" class="svelte-rfuq4y"/> <span>Jastipku</span></a> <div class="nav-actions svelte-rfuq4y"><!> <!> <span class="spacer svelte-rfuq4y"></span> <!> <!></div></nav>');function Ye(d,q){ce(q,!1);const R=()=>A(U,"$authStore",r),o=()=>A(Se,"$page",r),l=()=>A(je,"$cartStore",r),[r,i]=ye(),s=b(),g=b(),I=b(),L=b(),O=b();let V=E(q,"showLanguage",8,!1),D=E(q,"language",8,"id"),M=E(q,"languages",24,()=>[{value:"id",label:"Indonesia"},{value:"en",label:"English"}]);const X=ie(),Z=[{label:"Browse",href:"/browse",allowedRoles:["user"]},{label:"Pesanan Saya",href:"/orders",allowedRoles:["user"]},{label:"Chat",href:"/chats",allowedRoles:["user"]},{label:"Ulasan Saya",href:"/reviews",allowedRoles:["user"]},{label:"Profil",href:"/profile",allowedRoles:["user"]},{label:"Dashboard",href:"/jastiper",allowedRoles:["jastiper"]},{label:"Pesanan",href:"/jastiper/orders",allowedRoles:["jastiper"]},{label:"Postingan Saya",href:"/jastiper/listings",allowedRoles:["jastiper"]},{label:"Chat",href:"/jastiper/chats",allowedRoles:["jastiper"]},{label:"Wallet",href:"/jastiper/wallet",allowedRoles:["jastiper"]},{label:"Profil",href:"/jastiper/profile",allowedRoles:["jastiper"]}];let P=b(D()),J=b({role:"guest"});function ee(a){X("languageChange",a.target.value)}function ae(){U.set({role:"guest"}),we("/")}y(()=>G(D()),()=>{m(P,D())}),y(()=>R(),()=>{m(J,R())}),y(()=>e(J),()=>{m(s,e(J).role??"guest")}),y(()=>e(s),()=>{m(g,e(s)!=="guest")}),y(()=>o(),()=>{m(I,o().url.pathname)}),y(()=>l(),()=>{m(L,l())}),y(()=>e(L),()=>{m(O,e(L).items.reduce((a,t)=>a+t.quantity,0))}),ue(),be();var N=De(),T=w(p(N),2),W=p(T);Q(W,1,()=>(e(s),S(()=>Z.filter(a=>a.allowedRoles.includes(e(s))))),a=>a.href,(a,t)=>{var n=Ie();let f;var c=p(n,!0);v(n),x(u=>{f=me(n,1,"nav-link svelte-rfuq4y",null,f,u),he(n,"href",(e(t),S(()=>e(t).href))),k(c,(e(t),S(()=>e(t).label)))},[()=>({active:e(I)===e(t).href||e(I).startsWith(e(t).href+"/")})]),h(a,n)});var $=w(W,2);{var te=a=>{var t=Pe(),n=w(p(t),2);{var f=c=>{var u=xe(),j=p(u,!0);v(u),x(()=>k(j,e(O))),h(c,u)};C(n,c=>{e(O)>0&&c(f)})}v(t),h(a,t)};C($,a=>{e(s)==="user"&&a(te)})}var z=w($,4);{var re=a=>{var t=ke();ve(2),h(a,t)},se=a=>{var t=Ce(),n=de(t),f=p(n),c=p(f,!0);v(f),v(n);var u=w(n,2);x(()=>k(c,(G(Y),e(s),S(()=>{var j;return((j=Y[e(s)])==null?void 0:j.label)??e(s)})))),K("click",u,ae),h(a,t)};C(z,a=>{e(g)?a(se,!1):a(re)})}var le=w(z,2);{var oe=a=>{var t=Oe(),n=w(p(t),2);x(()=>{e(P),pe(()=>{M()})}),Q(n,5,M,ge,(f,c)=>{var u=Le(),j=p(u,!0);v(u);var B={};x(()=>{k(j,(e(c),S(()=>e(c).label))),B!==(B=(e(c),S(()=>e(c).value)))&&(u.value=(u.__value=(e(c),S(()=>e(c).value)))??"")}),h(f,u)}),v(n),v(t),_e(n,()=>e(P),f=>m(P,f)),K("change",n,ee),h(a,t)};C(le,a=>{V()&&a(oe)})}v(T),v(N),h(d,N),fe(),i()}export{Ye as N,je as c};
