import{f as g,a as h}from"../chunks/CUf5UZYF.js";import"../chunks/BoQy5TvO.js";import{o as Da,g as La}from"../chunks/JjBbrouE.js";import{a6 as Ma,a7 as ta,a8 as Pa,i as a,ab as Sa,z as C,ac as l,k as b,a4 as i,a5 as s,u as n,aa as H,ae as $a}from"../chunks/C6kp5iGx.js";import{s as c,e as O}from"../chunks/Dvw9CKj1.js";import{i as ea}from"../chunks/BMTi0gWB.js";import{b as Aa,e as U,i as sa}from"../chunks/DPurX8ys.js";import{r as ia,s as ja}from"../chunks/CK8WfoRq.js";import{s as Ba}from"../chunks/D6eV9jrv.js";import{b as la}from"../chunks/BXzdIX3i.js";import{i as Ea}from"../chunks/BvILkHPm.js";import{g as Ra}from"../chunks/BqC4448f.js";import{S as Ta}from"../chunks/MSclBbtX.js";import{o as Ia,s as Na}from"../chunks/tGRDOfAf.js";var za=g('<p class="empty svelte-1b0lhtv">Belum ada permintaan yang perlu negosiasi. Pesanan baru akan muncul di halaman Pending.</p>'),Ha=g("<li> </li>"),Oa=g('<div><div class="meta svelte-1b0lhtv"><span class="svelte-1b0lhtv"> </span> <span class="svelte-1b0lhtv"> </span></div> <p class="svelte-1b0lhtv"> </p></div>'),Ua=g('<div class="chat svelte-1b0lhtv"><header class="svelte-1b0lhtv">Chat dengan Pengguna</header> <div class="thread svelte-1b0lhtv"></div> <div class="composer svelte-1b0lhtv"><input placeholder="Ketik pesan untuk pengguna" class="svelte-1b0lhtv"/> <button type="button" class="svelte-1b0lhtv">Kirim</button></div></div>'),Va=g('<article class="card svelte-1b0lhtv"><header class="svelte-1b0lhtv"><div><h2 class="svelte-1b0lhtv"> </h2> <p class="svelte-1b0lhtv"> </p></div> <!></header> <div class="info svelte-1b0lhtv"><div><span class="svelte-1b0lhtv">Produk</span> <strong> </strong></div> <div><span class="svelte-1b0lhtv">Variasi</span> <strong> </strong></div> <div><span class="svelte-1b0lhtv">Estimasi Total</span> <strong> </strong></div></div> <ul class="notes svelte-1b0lhtv"></ul> <div class="actions svelte-1b0lhtv"><a class="primary svelte-1b0lhtv">Review & Kirim Counter</a> <button class="ghost svelte-1b0lhtv" type="button"> </button></div> <!></article>'),qa=g('<div class="list svelte-1b0lhtv"></div>'),Fa=g('<section class="negotiations svelte-1b0lhtv"><a class="back-link svelte-1b0lhtv" href="/admin">← Kembali</a> <header class="svelte-1b0lhtv"><div><h1 class="svelte-1b0lhtv">Daftar Negosiasi</h1> <p class="svelte-1b0lhtv">Kelola permintaan yang membutuhkan penawaran ulang harga atau detail produk.</p></div> <a href="/admin" class="back svelte-1b0lhtv">← Kembali ke Dashboard</a></header> <div class="toolbar svelte-1b0lhtv"><label class="svelte-1b0lhtv">Cari <input placeholder="Cari kode, toko, atau produk" class="svelte-1b0lhtv"/></label></div> <!></section>');function nt(va,na){Ma(na,!1);const _=C(),ra=Ia.filter(t=>t.status==="Perlu_Negosiasi").map(t=>({...t,notes:["Harga perlu disesuaikan dengan pajak lokal.","Konfirmasi stok warna/ukuran terakhir."],chats:[{sender:"Admin",message:"Kami melihat harga toko naik 10%. Apakah tetap lanjut?",time:"09.15"},{sender:"User",message:"Boleh, asalkan total tidak lebih dari Rp 3 juta.",time:"09.22"}]}));let y=C(""),u=C({}),o=C({}),f=C(null);function oa(t){b(f,a(f)===t?null:t)}function V(t){var r;const v=(r=a(o)[t])==null?void 0:r.trim();v&&(b(u,{...a(u),[t]:[...a(u)[t],{sender:"Admin",message:v,time:new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}]}),b(o,{...a(o),[t]:""}))}Da(()=>{const{role:t}=La(Aa);t!=="admin"&&Ra("/login?redirect=/admin/negotiations&expected=admin")}),ta(()=>a(y),()=>{b(_,ra.filter(t=>{const v=a(y).trim().toLowerCase();return v?t.code.toLowerCase().includes(v)||t.store.toLowerCase().includes(v)||t.product.toLowerCase().includes(v):!0}))}),ta(()=>(a(u),a(o),a(_)),()=>{let t=a(u),v=a(o);a(_).forEach(r=>{t[r.code]||(t={...t,[r.code]:r.chats}),v[r.code]===void 0&&(v={...v,[r.code]:""})}),t!==a(u)&&b(u,t),v!==a(o)&&b(o,v)}),Pa(),Ea();var L=Fa(),M=l(i(L),4),q=i(M),F=l(i(q));ia(F),s(q),s(M);var ca=l(M,2);{var ua=t=>{var v=za();h(t,v)},da=t=>{var v=qa();U(v,5,()=>a(_),r=>r.code,(r,e)=>{var P=Va(),S=i(P),$=i(S),A=i($),pa=i(A,!0);s(A);var G=l(A,2),ma=i(G);s(G),s($);var ha=l($,2);Ta(ha,{get statusMeta(){return Na},get status(){return a(e),n(()=>a(e).status)}}),s(S);var j=l(S,2),B=i(j),J=l(i(B),2),ba=i(J,!0);s(J),s(B);var E=l(B,2),Q=l(i(E),2),ga=i(Q,!0);s(Q),s(E);var W=l(E,2),X=l(i(W),2),_a=i(X);s(X),s(W),s(j);var R=l(j,2);U(R,5,()=>(a(e),n(()=>a(e).notes)),sa,(p,x)=>{var m=Ha(),w=i(m);s(m),H(()=>c(w,`• ${a(x)??""}`)),h(p,m)}),s(R);var T=l(R,2),Y=i(T),I=l(Y,2),fa=i(I,!0);s(I),s(T);var ka=l(T,2);{var xa=p=>{var x=Ua(),m=l(i(x),2);U(m,5,()=>(a(u),a(e),n(()=>a(u)[a(e).code]??[])),sa,(k,d)=>{var D=Oa(),N=i(D),z=i(N),ya=i(z,!0);s(z);var Z=l(z,2),wa=i(Z,!0);s(Z),s(N);var aa=l(N,2),Ka=i(aa,!0);s(aa),s(D),H(()=>{Ba(D,1,(a(d),n(()=>`bubble ${a(d).sender==="Admin"?"admin":"user"}`)),"svelte-1b0lhtv"),c(ya,(a(d),n(()=>a(d).sender))),c(wa,(a(d),n(()=>a(d).time))),c(Ka,(a(d),n(()=>a(d).message)))}),h(k,D)}),s(m);var w=l(m,2),K=i(w);ia(K);var Ca=l(K,2);s(w),s(x),la(K,()=>a(o)[a(e).code],k=>$a(o,a(o)[a(e).code]=k)),O("keydown",K,k=>{k.key==="Enter"&&(k.preventDefault(),V(a(e).code))}),O("click",Ca,()=>V(a(e).code)),h(p,x)};ea(ka,p=>{a(f),a(e),n(()=>a(f)===a(e).code)&&p(xa)})}s(P),H(p=>{c(pa,(a(e),n(()=>a(e).code))),c(ma,`${a(e),n(()=>a(e).store)??""} · ${a(e),n(()=>a(e).country)??""}`),c(ba,(a(e),n(()=>a(e).product))),c(ga,(a(e),n(()=>a(e).variations))),c(_a,`Rp ${p??""}`),ja(Y,"href",(a(e),n(()=>`/admin/review/${a(e).code}?mode=negosiasi`))),c(fa,(a(f),a(e),n(()=>a(f)===a(e).code?"Tutup Chat":"Lihat Chat")))},[()=>(a(e),n(()=>a(e).estimate.toLocaleString("id-ID")))]),O("click",I,()=>oa(a(e).code)),h(r,P)}),s(v),h(t,v)};ea(ca,t=>{a(_),n(()=>a(_).length===0)?t(ua):t(da,!1)})}s(L),la(F,()=>a(y),t=>b(y,t)),h(va,L),Sa()}export{nt as component};
