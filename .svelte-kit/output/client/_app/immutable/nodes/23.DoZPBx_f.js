import{f as y,a as _}from"../chunks/CUf5UZYF.js";import"../chunks/BoQy5TvO.js";import{o as pe}from"../chunks/JjBbrouE.js";import{a6 as _e,a7 as X,a8 as ye,a9 as Y,i as e,ab as fe,z as I,ac as o,k as L,a4 as r,a5 as s,u as v,aa as b,a2 as Z}from"../chunks/C6kp5iGx.js";import{s as d,e as $}from"../chunks/Dvw9CKj1.js";import{i as C}from"../chunks/BMTi0gWB.js";import{b as ze,e as ee}from"../chunks/DPurX8ys.js";import{r as he}from"../chunks/CK8WfoRq.js";import{s as ae}from"../chunks/D6eV9jrv.js";import{b as be}from"../chunks/BXzdIX3i.js";import{i as ge}from"../chunks/BvILkHPm.js";import{g as xe}from"../chunks/BqC4448f.js";import{c as U}from"../chunks/tGRDOfAf.js";import{N as Ce}from"../chunks/CAlpgxxh.js";var ke=y('<span class="unread-badge svelte-cmz2yo"> </span>'),we=y('<div class="chat-order-code svelte-cmz2yo"> </div>'),De=y('<span class="unread-count svelte-cmz2yo"> </span>'),Le=y('<button><div class="chat-avatar svelte-cmz2yo"> </div> <div class="chat-info svelte-cmz2yo"><div class="chat-name-row svelte-cmz2yo"><span class="chat-name svelte-cmz2yo"> </span> <span class="chat-time svelte-cmz2yo"> </span></div> <div class="chat-last-message svelte-cmz2yo"> </div> <!></div> <!></button>'),je=y('<div class="empty-chat-list svelte-cmz2yo"><div class="empty-icon svelte-cmz2yo">ğŸ’¬</div> <p class="svelte-cmz2yo">Tidak ada pesan ditemukan</p></div>'),Me=y('<div class="chat-detail-order svelte-cmz2yo"> </div>'),Ne=y('<div><div class="message-bubble svelte-cmz2yo"><p class="message-text svelte-cmz2yo"> </p> <span class="message-time svelte-cmz2yo"> </span></div></div>'),Se=y('<div class="chat-detail-header svelte-cmz2yo"><button class="back-button svelte-cmz2yo">â†</button> <div class="chat-detail-avatar svelte-cmz2yo"> </div> <div class="chat-detail-info svelte-cmz2yo"><div class="chat-detail-name svelte-cmz2yo"> </div> <!></div> <button class="more-button svelte-cmz2yo">â‹®</button></div> <div class="messages-container svelte-cmz2yo"></div> <div class="message-input svelte-cmz2yo"><button class="attach-button svelte-cmz2yo">ğŸ“</button> <input type="text" placeholder="Ketik pesan..." class="svelte-cmz2yo"/> <button class="send-button svelte-cmz2yo">ğŸ“¤</button></div>',1),Te=y('<div class="no-chat-selected svelte-cmz2yo"><div class="no-chat-icon svelte-cmz2yo">ğŸ’¬</div> <h3 class="svelte-cmz2yo">Pilih Chat</h3> <p class="svelte-cmz2yo">Pilih percakapan dari daftar untuk melihat pesan</p></div>'),Ie=y('<!> <div class="container svelte-cmz2yo"><div class="chat-layout svelte-cmz2yo"><div class="chat-list svelte-cmz2yo"><div class="chat-list-header svelte-cmz2yo"><h2 class="svelte-cmz2yo">Pesan</h2> <!></div> <div class="search-box svelte-cmz2yo"><span class="search-icon svelte-cmz2yo">ğŸ”</span> <input type="text" placeholder="Cari pesan..." class="svelte-cmz2yo"/></div> <div class="chat-items svelte-cmz2yo"></div> <!></div> <div class="chat-detail svelte-cmz2yo"><!></div></div></div>',1);function Ve(te,se){_e(se,!1);const j=I(),P=I();let q="guest";ze.subscribe(t=>{q=t.role}),pe(()=>{if(q!=="user"){xe("/login?redirect=/chats&expected=user");return}});let i=I(null),g=I("");function re(t){L(i,t),t.unreadCount=0}function B(t){const a=new Date(t),z=new Date-a,n=Math.floor(z/(1e3*60*60*24));return n===0?a.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):n===1?"Kemarin":n<7?a.toLocaleDateString("id-ID",{weekday:"long"}):a.toLocaleDateString("id-ID",{day:"numeric",month:"short"})}function oe(){L(i,null)}X(()=>e(g),()=>{L(j,U.filter(t=>e(g)===""||t.jastiperName.toLowerCase().includes(e(g).toLowerCase())||t.lastMessage.toLowerCase().includes(e(g).toLowerCase())))}),X(()=>U,()=>{L(P,U.reduce((t,a)=>t+a.unreadCount,0))}),ye(),ge();var E=Ie(),F=Y(E);Ce(F,{});var G=o(F,2),J=r(G),A=r(J),K=r(A),ve=o(r(K),2);{var ie=t=>{var a=ke(),c=r(a,!0);s(a),b(()=>d(c,e(P))),_(t,a)};C(ve,t=>{e(P)>0&&t(ie)})}s(K);var H=o(K,2),V=o(r(H),2);he(V),s(H);var O=o(H,2);ee(O,5,()=>e(j),t=>t.id,(t,a)=>{var c=Le();let z;var n=r(c),Q=r(n,!0);s(n);var x=o(n,2),h=r(x),k=r(h),R=r(k,!0);s(k);var M=o(k,2),N=r(M,!0);s(M),s(h);var m=o(h,2),u=r(m,!0);s(m);var f=o(m,2);{var S=p=>{var l=we(),D=r(l);s(l),b(()=>d(D,`ğŸ“¦ ${e(a),v(()=>e(a).orderCode)??""}`)),_(p,l)};C(f,p=>{e(a),v(()=>e(a).orderCode)&&p(S)})}s(x);var T=o(x,2);{var w=p=>{var l=De(),D=r(l,!0);s(l),b(()=>d(D,(e(a),v(()=>e(a).unreadCount)))),_(p,l)};C(T,p=>{e(a),v(()=>e(a).unreadCount>0)&&p(w)})}s(c),b(p=>{var l;z=ae(c,1,"chat-item svelte-cmz2yo",null,z,{active:((l=e(i))==null?void 0:l.id)===e(a).id,unread:e(a).unreadCount>0}),d(Q,(e(a),v(()=>e(a).jastiperAvatar))),d(R,(e(a),v(()=>e(a).jastiperName))),d(N,p),d(u,(e(a),v(()=>e(a).lastMessage)))},[()=>(e(a),v(()=>B(e(a).lastMessageTime)))]),$("click",c,()=>re(e(a))),_(t,c)}),s(O);var le=o(O,2);{var ce=t=>{var a=je();_(t,a)};C(le,t=>{e(j),v(()=>e(j).length===0)&&t(ce)})}s(A);var W=o(A,2),de=r(W);{var ne=t=>{var a=Se(),c=Y(a),z=r(c),n=o(z,2),Q=r(n,!0);s(n);var x=o(n,2),h=r(x),k=r(h,!0);s(h);var R=o(h,2);{var M=m=>{var u=Me(),f=r(u);s(u),b(()=>d(f,`Order: ${e(i),v(()=>e(i).orderCode)??""}`)),_(m,u)};C(R,m=>{e(i),v(()=>e(i).orderCode)&&m(M)})}s(x),Z(2),s(c);var N=o(c,2);ee(N,5,()=>(e(i),v(()=>e(i).messages)),m=>m.id,(m,u)=>{var f=Ne();let S;var T=r(f),w=r(T),p=r(w,!0);s(w);var l=o(w,2),D=r(l,!0);s(l),s(T),s(f),b(ue=>{S=ae(f,1,"message svelte-cmz2yo",null,S,{own:e(u).sender==="user"}),d(p,(e(u),v(()=>e(u).text))),d(D,ue)},[()=>(e(u),v(()=>B(e(u).timestamp)))]),_(m,f)}),s(N),Z(2),b(()=>{d(Q,(e(i),v(()=>e(i).jastiperAvatar))),d(k,(e(i),v(()=>e(i).jastiperName)))}),$("click",z,oe),_(t,a)},me=t=>{var a=Te();_(t,a)};C(de,t=>{e(i)?t(ne):t(me,!1)})}s(W),s(J),s(G),be(V,()=>e(g),t=>L(g,t)),_(te,E),fe()}export{Ve as component};
