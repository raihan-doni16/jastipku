import{f as b,a as _}from"../chunks/CUf5UZYF.js";import"../chunks/BoQy5TvO.js";import{o as va}from"../chunks/JjBbrouE.js";import{a6 as oa,a7 as Je,a8 as ca,a9 as da,aa as g,ab as ua,i as e,z as G,ae as x,u as l,a4 as i,ac as s,k as J,a5 as t,a2 as Q,af as ma,ad as Se}from"../chunks/C6kp5iGx.js";import{e as A,s as d}from"../chunks/Dvw9CKj1.js";import{i as X}from"../chunks/BMTi0gWB.js";import{b as pa,e as me,i as Ve}from"../chunks/DPurX8ys.js";import{r as pe}from"../chunks/CK8WfoRq.js";import{s as Fe}from"../chunks/D6eV9jrv.js";import{s as Ue}from"../chunks/BfAcoFpJ.js";import{b as fe,a as fa}from"../chunks/BXzdIX3i.js";import{b as Ee}from"../chunks/oa8gdtCF.js";import{i as _a}from"../chunks/BvILkHPm.js";import{g as ga}from"../chunks/BqC4448f.js";import{M as ba}from"../chunks/DIG4Q-3q.js";var ja=b("<option> </option>"),ha=b("<option> </option>"),ka=b('<div class="form-group svelte-11ejrir"><label for="scheduledTime" class="svelte-11ejrir">Jadwalkan Waktu Pengiriman</label> <input id="scheduledTime" type="datetime-local" class="svelte-11ejrir"/></div>'),xa=b('<div class="section svelte-11ejrir"><div class="section-header svelte-11ejrir"><h2 class="svelte-11ejrir">Buat Notifikasi Baru</h2></div> <div class="notification-form svelte-11ejrir"><div class="form-group svelte-11ejrir"><label for="title" class="svelte-11ejrir">Judul Notifikasi <span class="required svelte-11ejrir">*</span></label> <input id="title" type="text" placeholder="Masukkan judul notifikasi..." maxlength="100" class="svelte-11ejrir"/> <div class="char-count svelte-11ejrir"> </div></div> <div class="form-group svelte-11ejrir"><label for="message" class="svelte-11ejrir">Pesan <span class="required svelte-11ejrir">*</span></label> <textarea id="message" placeholder="Tulis pesan notifikasi di sini..." rows="5" maxlength="500" class="svelte-11ejrir"></textarea> <div class="char-count svelte-11ejrir"> </div></div> <div class="form-row svelte-11ejrir"><div class="form-group svelte-11ejrir"><label for="type" class="svelte-11ejrir">Tipe Notifikasi</label> <select id="type" class="svelte-11ejrir"></select></div> <div class="form-group svelte-11ejrir"><label for="audience" class="svelte-11ejrir">Target Penerima <span class="required svelte-11ejrir">*</span></label> <select id="audience" class="svelte-11ejrir"></select></div></div> <div class="recipients-info svelte-11ejrir"><div class="info-icon svelte-11ejrir">üë•</div> <div class="info-text svelte-11ejrir"><strong>Estimasi Penerima:</strong> </div></div> <div class="form-group svelte-11ejrir"><label class="checkbox-label svelte-11ejrir"><input type="checkbox" class="svelte-11ejrir"/> Kirim sekarang</label></div> <!> <div class="form-actions svelte-11ejrir"><button class="btn-secondary svelte-11ejrir">Simpan Draft</button> <button class="btn-secondary svelte-11ejrir">Preview</button> <button class="btn-primary svelte-11ejrir"> </button></div></div></div>'),ya=b('<div class="stat svelte-11ejrir"><span class="stat-label svelte-11ejrir">Open Rate</span> <span class="stat-value svelte-11ejrir"> </span></div>'),Ta=b('<div class="notification-card svelte-11ejrir"><div class="notification-header svelte-11ejrir"><div class="notification-title-section svelte-11ejrir"><div class="type-icon svelte-11ejrir"> </div> <div><h3 class="notification-title svelte-11ejrir"> </h3> <div class="notification-meta svelte-11ejrir"><span class="type-badge svelte-11ejrir"> </span> <span class="status-badge svelte-11ejrir"> </span></div></div></div> <div class="notification-date svelte-11ejrir"> </div></div> <div class="notification-content svelte-11ejrir"><p class="notification-message svelte-11ejrir"> </p> <div class="notification-stats svelte-11ejrir"><div class="stat svelte-11ejrir"><span class="stat-label svelte-11ejrir">Penerima</span> <span class="stat-value svelte-11ejrir"> </span></div> <!></div></div> <div class="notification-actions svelte-11ejrir"><button class="btn-secondary svelte-11ejrir">Lihat Detail</button> <button class="btn-remove svelte-11ejrir">Hapus</button></div></div>'),wa=b('<div class="empty-state svelte-11ejrir"><div class="empty-icon svelte-11ejrir">üì¨</div> <h3 class="svelte-11ejrir">Belum ada riwayat</h3> <p class="svelte-11ejrir">Notifikasi yang terkirim akan muncul di sini</p></div>'),$a=b('<div class="section svelte-11ejrir"><div class="section-header svelte-11ejrir"><h2 class="svelte-11ejrir">Riwayat Pengiriman</h2></div> <div class="results-info svelte-11ejrir"> </div> <div class="notifications-list svelte-11ejrir"></div> <!></div>'),Pa=b('<!> <div class="container svelte-11ejrir"><div class="header svelte-11ejrir"><h1 class="svelte-11ejrir">Notifikasi & Broadcast</h1> <p class="svelte-11ejrir">Kirim pengumuman dan promosi ke pengguna</p></div> <div class="stats-cards svelte-11ejrir"><div class="stat-card svelte-11ejrir"><div class="stat-icon svelte-11ejrir" style="background: #d1fae5;">üì§</div> <div class="stat-content svelte-11ejrir"><div class="stat-value svelte-11ejrir"> </div> <div class="stat-label svelte-11ejrir">Notifikasi Terkirim</div></div></div> <div class="stat-card svelte-11ejrir"><div class="stat-icon svelte-11ejrir" style="background: #fef3c7;">‚è∞</div> <div class="stat-content svelte-11ejrir"><div class="stat-value svelte-11ejrir"> </div> <div class="stat-label svelte-11ejrir">Terjadwal</div></div></div> <div class="stat-card svelte-11ejrir"><div class="stat-icon svelte-11ejrir" style="background: #dbeafe;">üë•</div> <div class="stat-content svelte-11ejrir"><div class="stat-value svelte-11ejrir"> </div> <div class="stat-label svelte-11ejrir">Total Penerima</div></div></div> <div class="stat-card svelte-11ejrir"><div class="stat-icon svelte-11ejrir" style="background: #e9d5ff;">ÔøΩÔøΩ</div> <div class="stat-content svelte-11ejrir"><div class="stat-value svelte-11ejrir"> </div> <div class="stat-label svelte-11ejrir">Avg. Open Rate</div></div></div></div> <div class="tabs svelte-11ejrir"><button>Buat Notifikasi</button> <button>Riwayat Pengiriman</button></div> <!> <!></div>',1);function qa(qe,He){oa(He,!1);const S=G(),V=G();let _e="guest";pa.subscribe(a=>{_e=a.role}),va(()=>{if(_e!=="admin"){ga("/login?redirect=/admin/notifications&expected=admin");return}});const j=[{id:"notif-1",title:"Promo Flash Sale Akhir Tahun",message:"Dapatkan diskon hingga 50% untuk semua produk jastip! Buruan sebelum kehabisan!",type:"promo",targetAudience:"all_users",status:"sent",sentAt:"2024-01-17T10:00:00",totalRecipients:1250,openRate:45.6},{id:"notif-2",title:"Maintenance Terjadwal",message:"Sistem akan maintenance pada tanggal 20 Januari 2024 pukul 01:00 - 03:00 WIB.",type:"announcement",targetAudience:"all",status:"sent",sentAt:"2024-01-16T15:30:00",totalRecipients:2500,openRate:78.4},{id:"notif-3",title:"Verifikasi Akun Jastiper",message:"Segera lengkapi dokumen verifikasi Anda untuk mulai berjualan.",type:"reminder",targetAudience:"unverified_jastiper",status:"sent",sentAt:"2024-01-15T09:00:00",totalRecipients:45,openRate:62.2},{id:"notif-4",title:"Update Fitur Baru",message:"Fitur chat langsung dengan jastiper telah tersedia! Coba sekarang.",type:"feature_update",targetAudience:"all_users",status:"scheduled",sentAt:"2024-01-20T08:00:00",totalRecipients:0,openRate:0}];let r=G({title:"",message:"",type:"announcement",targetAudience:"all",scheduledTime:"",sendNow:!0});const Ie=[{value:"announcement",label:"Pengumuman",icon:"üì¢"},{value:"promo",label:"Promosi",icon:"üéâ"},{value:"reminder",label:"Pengingat",icon:"‚è∞"},{value:"feature_update",label:"Update Fitur",icon:"‚ú®"},{value:"maintenance",label:"Maintenance",icon:"üîß"}],ge=[{value:"all",label:"Semua Pengguna",count:2500},{value:"all_users",label:"Semua Pembeli",count:1250},{value:"all_jastiper",label:"Semua Jastiper",count:850},{value:"verified_jastiper",label:"Jastiper Terverifikasi",count:720},{value:"unverified_jastiper",label:"Jastiper Belum Verifikasi",count:130},{value:"active_users",label:"User Aktif (30 hari)",count:980},{value:"inactive_users",label:"User Tidak Aktif",count:270}];let O=G("create"),v=G({isOpen:!1,type:"info",title:"",message:"",confirmText:"OK",cancelText:"Batal",showCancel:!1,inputValue:"",inputPlaceholder:"",onConfirm:null});function f(a){J(v,{isOpen:!0,type:a.type||"info",title:a.title||"",message:a.message||"",confirmText:a.confirmText||"OK",cancelText:a.cancelText||"Batal",showCancel:a.showCancel||!1,inputValue:a.inputValue||"",inputPlaceholder:a.inputPlaceholder||"",onConfirm:a.onConfirm||null})}function Le(a){e(v).onConfirm&&(e(v).type==="prompt"&&a.detail!==void 0?e(v).onConfirm(a.detail):e(v).onConfirm())}function be(a){return a?new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function Z(a){return{announcement:{label:"Pengumuman",color:"#3b82f6",icon:"üì¢"},promo:{label:"Promosi",color:"#f59e0b",icon:"üéâ"},reminder:{label:"Pengingat",color:"#8b5cf6",icon:"‚è∞"},feature_update:{label:"Update Fitur",color:"#10b981",icon:"‚ú®"},maintenance:{label:"Maintenance",color:"#ef4444",icon:"üîß"}}[a]||{label:a,color:"#64748b",icon:"üì¨"}}function je(a){return{sent:{label:"Terkirim",color:"#10b981"},scheduled:{label:"Terjadwal",color:"#f59e0b"},draft:{label:"Draft",color:"#94a3b8"},failed:{label:"Gagal",color:"#ef4444"}}[a]||{label:a,color:"#64748b"}}function We(){if(!e(r).title||!e(r).message){f({type:"error",title:"Error",message:"Mohon lengkapi judul dan pesan notifikasi",confirmText:"OK"});return}if(!e(r).sendNow&&!e(r).scheduledTime){f({type:"error",title:"Error",message:"Mohon tentukan waktu pengiriman atau pilih kirim sekarang",confirmText:"OK"});return}const a=e(r).sendNow?`Kirim notifikasi sekarang ke ${e(V)} pengguna?`:`Jadwalkan notifikasi untuk ${be(e(r).scheduledTime)}?`;f({type:"confirm",title:"Konfirmasi",message:a,confirmText:"Ya",cancelText:"Batal",showCancel:!0,onConfirm:()=>{var u;f({type:"success",title:"Berhasil",message:`Notifikasi berhasil ${e(r).sendNow?"dikirim":"dijadwalkan"}!

Judul: ${e(r).title}
Target: ${(u=e(S))==null?void 0:u.label}
Penerima: ${e(V)} orang`,confirmText:"OK"}),J(r,{title:"",message:"",type:"announcement",targetAudience:"all",scheduledTime:"",sendNow:!0})}})}function Ye(){if(!e(r).title||!e(r).message){f({type:"error",title:"Error",message:"Mohon lengkapi judul dan pesan notifikasi",confirmText:"OK"});return}f({type:"success",title:"Berhasil",message:"Draft notifikasi berhasil disimpan!",confirmText:"OK"})}function ze(){var a;f({type:"info",title:"Preview Notifikasi",message:`${Z(e(r).type).icon} ${e(r).title}

${e(r).message}

Target: ${(a=e(S))==null?void 0:a.label} (${e(V)} orang)`,confirmText:"OK"})}function Ge(a){f({type:"info",title:"Detail Notifikasi",message:`Membuka detail notifikasi ${a}`,confirmText:"OK"})}function Qe(a){f({type:"confirm",title:"Konfirmasi",message:"Hapus notifikasi ini dari riwayat?",confirmText:"Ya",cancelText:"Batal",showCancel:!0,onConfirm:()=>{f({type:"success",title:"Berhasil",message:`Notifikasi ${a} dihapus`,confirmText:"OK"})}})}Je(()=>e(r),()=>{J(S,ge.find(a=>a.value===e(r).targetAudience))}),Je(()=>e(S),()=>{var a;J(V,((a=e(S))==null?void 0:a.count)||0)}),ca(),_a();var he=Pa(),ke=da(he);ba(ke,{get type(){return e(v),l(()=>e(v).type)},get title(){return e(v),l(()=>e(v).title)},get message(){return e(v),l(()=>e(v).message)},get confirmText(){return e(v),l(()=>e(v).confirmText)},get cancelText(){return e(v),l(()=>e(v).cancelText)},get showCancel(){return e(v),l(()=>e(v).showCancel)},get inputPlaceholder(){return e(v),l(()=>e(v).inputPlaceholder)},get isOpen(){return e(v).isOpen},set isOpen(a){x(v,e(v).isOpen=a)},get inputValue(){return e(v).inputValue},set inputValue(a){x(v,e(v).inputValue=a)},$$events:{confirm:Le},$$legacy:!0});var xe=s(ke,2),se=s(i(xe),2),re=i(se),ye=s(i(re),2),Te=i(ye),Xe=i(Te,!0);t(Te),Q(2),t(ye),t(re);var le=s(re,2),we=s(i(le),2),$e=i(we),Ze=i($e,!0);t($e),Q(2),t(we),t(le);var ne=s(le,2),Pe=s(i(ne),2),Ne=i(Pe),ea=i(Ne,!0);t(Ne),Q(2),t(Pe),t(ne);var Ae=s(ne,2),Oe=s(i(Ae),2),Be=i(Oe),aa=i(Be);t(Be),Q(2),t(Oe),t(Ae),t(se);var ve=s(se,2),oe=i(ve);let Ce;var Re=s(oe,2);let Ke;t(ve);var Me=s(ve,2);{var ta=a=>{var u=xa(),h=s(i(u),2),y=i(h),T=s(i(y),2);pe(T);var ee=s(T,2),ce=i(ee);t(ee),t(y);var p=s(y,2),n=s(i(p),2);ma(n);var B=s(n,2),F=i(B);t(B),t(p);var w=s(p,2),$=i(w),U=s(i($),2);g(()=>{e(r),Se(()=>{})}),me(U,5,()=>Ie,Ve,(c,o)=>{var m=ja(),N=i(m);t(m);var k={};g(()=>{d(N,`${e(o),l(()=>e(o).icon)??""} ${e(o),l(()=>e(o).label)??""}`),k!==(k=(e(o),l(()=>e(o).value)))&&(m.value=(m.__value=(e(o),l(()=>e(o).value)))??"")}),_(c,m)}),t(U),t($);var E=s($,2),P=s(i(E),2);g(()=>{e(r),Se(()=>{})}),me(P,5,()=>ge,Ve,(c,o)=>{var m=ha(),N=i(m);t(m);var k={};g(()=>{d(N,`${e(o),l(()=>e(o).label)??""} (${e(o),l(()=>e(o).count)??""})`),k!==(k=(e(o),l(()=>e(o).value)))&&(m.value=(m.__value=(e(o),l(()=>e(o).value)))??"")}),_(c,m)}),t(P),t(E),t(w);var q=s(w,2),H=s(i(q),2),C=s(i(H));t(H),t(q);var I=s(q,2),R=i(I),ae=i(R);pe(ae),Q(),t(R),t(I);var L=s(I,2);{var de=c=>{var o=ka(),m=s(i(o),2);pe(m),t(o),fe(m,()=>e(r).scheduledTime,N=>x(r,e(r).scheduledTime=N)),_(c,o)};X(L,c=>{e(r),l(()=>!e(r).sendNow)&&c(de)})}var K=s(L,2),M=i(K),te=s(M,2),D=s(te,2),W=i(D,!0);t(D),t(K),t(h),t(u),g(()=>{d(ce,`${e(r),l(()=>e(r).title.length)??""}/100`),d(F,`${e(r),l(()=>e(r).message.length)??""}/500`),d(C,` ${e(V)??""} pengguna`),d(W,(e(r),l(()=>e(r).sendNow?"Kirim Sekarang":"Jadwalkan Pengiriman")))}),fe(T,()=>e(r).title,c=>x(r,e(r).title=c)),fe(n,()=>e(r).message,c=>x(r,e(r).message=c)),Ee(U,()=>e(r).type,c=>x(r,e(r).type=c)),Ee(P,()=>e(r).targetAudience,c=>x(r,e(r).targetAudience=c)),fa(ae,()=>e(r).sendNow,c=>x(r,e(r).sendNow=c)),A("click",M,Ye),A("click",te,ze),A("click",D,We),_(a,u)};X(Me,a=>{e(O)==="create"&&a(ta)})}var ia=s(Me,2);{var sa=a=>{var u=$a(),h=s(i(u),2),y=i(h);t(h);var T=s(h,2);me(T,5,()=>j,p=>p.id,(p,n)=>{var B=Ta(),F=i(B),w=i(F),$=i(w),U=i($,!0);t($);var E=s($,2),P=i(E),q=i(P,!0);t(P);var H=s(P,2),C=i(H),I=i(C,!0);t(C);var R=s(C,2),ae=i(R,!0);t(R),t(H),t(E),t(w);var L=s(w,2),de=i(L,!0);t(L),t(F);var K=s(F,2),M=i(K),te=i(M,!0);t(M);var D=s(M,2),W=i(D),c=s(i(W),2),o=i(c,!0);t(c),t(W);var m=s(W,2);{var N=Y=>{var z=ya(),ie=s(i(z),2),ue=i(ie);t(ie),t(z),g(()=>d(ue,`${e(n),l(()=>e(n).openRate)??""}%`)),_(Y,z)};X(m,Y=>{e(n),l(()=>e(n).status==="sent")&&Y(N)})}t(D),t(K);var k=s(K,2),De=i(k),ra=s(De,2);t(k),t(B),g((Y,z,ie,ue,la,na)=>{d(U,Y),d(q,(e(n),l(()=>e(n).title))),Ue(C,`background-color: ${z??""};`),d(I,ie),Ue(R,`background-color: ${ue??""};`),d(ae,la),d(de,na),d(te,(e(n),l(()=>e(n).message))),d(o,(e(n),l(()=>e(n).totalRecipients)))},[()=>(e(n),l(()=>Z(e(n).type).icon)),()=>(e(n),l(()=>Z(e(n).type).color)),()=>(e(n),l(()=>Z(e(n).type).label)),()=>(e(n),l(()=>je(e(n).status).color)),()=>(e(n),l(()=>je(e(n).status).label)),()=>(e(n),l(()=>be(e(n).sentAt)))]),A("click",De,()=>Ge(e(n).id)),A("click",ra,()=>Qe(e(n).id)),_(p,B)}),t(T);var ee=s(T,2);{var ce=p=>{var n=wa();_(p,n)};X(ee,p=>{l(()=>j.length===0)&&p(ce)})}t(u),g(()=>d(y,`Menampilkan ${l(()=>j.length)??""} notifikasi`)),_(a,u)};X(ia,a=>{e(O)==="history"&&a(sa)})}t(xe),g((a,u,h,y)=>{d(Xe,a),d(Ze,u),d(ea,h),d(aa,`${y??""}%`),Ce=Fe(oe,1,"tab-button svelte-11ejrir",null,Ce,{active:e(O)==="create"}),Ke=Fe(Re,1,"tab-button svelte-11ejrir",null,Ke,{active:e(O)==="history"})},[()=>l(()=>j.filter(a=>a.status==="sent").length),()=>l(()=>j.filter(a=>a.status==="scheduled").length),()=>l(()=>j.reduce((a,u)=>a+u.totalRecipients,0)),()=>l(()=>Math.round(j.filter(a=>a.status==="sent").reduce((a,u)=>a+u.openRate,0)/j.filter(a=>a.status==="sent").length||0))]),A("click",oe,()=>J(O,"create")),A("click",Re,()=>J(O,"history")),_(qe,he),ua()}export{qa as component};
